After investigation of a lot actual armed combat, I made this Rebalance for Two-Handed Weapon Style, Sword and Shield Style, Single-Weapon Style and Two-Weapon Style, in order that all Weapon Styles are useful.
Intelligence/Wisdom/Charisma also brings extra modifiers.
All ajustments take effect only in combat, not in peacetime.
You can click the mode switch button on the protagonist's skill bar to activate the mechanism or not. The button is obtained in the first battle. 


///////////Compatibility & bugs////////////

This MOD doesn't modify any of the original game data, it only temporarily adds additional adjustments in combat, so it is compatible with everything.


///////////Components///////////

①Rebalance for Weapon Styles

You can click the mode switching button on the protagonist's Special Abilities bar to chooce modification modes. The button is automatically obtained in the first battle. 
Mode 1 (by default): turns on all effects, for both allies and foes. 
Mode 2: turn off Detailed ajustments for weapon types ( and Extra modifications of Intelligence/Wisdom/Charisma if Component 3 is installed ), only retains Modification of Weapon Styles, for both allies and foes. 
Mode 3: turn on all effects, valid only for teammates. 
Mode 4: turn off Detailed ajustments for weapon types ( and Extra modifications of Intelligence/Wisdom/Charisma if Component 3 is installed ), only retains Modification of Weapon Styles, valid only for teammates. 
Mode 0: turn off all effects.

Modification of Weapon Styles:

[Single-Weapon Style]
1 Slot: +2 to attack speed, one special attack in each round for tripping your enemy, grappling him temporarily ( provides -2 penalty to his THAC0 and AC and make him unmovable ), and 75% chance to paralyze him or flip him to the floor.
2 Slots: +4 to attack speed, one special attack in each round for tripping your enemy, grappling him temporarily ( provides -4 penalty to his THAC0 and AC and make him unmovable ), stunning or flip him to the floor, with 10% chance to disarm his weapons (only affects humanoids). 
The tripping takes effect when the enemy's strength does not exceed the character's strength by more than 2 points. The enemy can also make a save vs. breath with a +6 bonus to avoid being tripped (-1 save penalty for every 4 levels of the attacker).
If you successfully tripped your opponent, or he is is already in a helpless state (stunned / hold / unconsciousness), you can continue to cast tripping without the limitation of once per round.
A hasted character can make two trip attacks in one round.
Some creatures (such as wraiths or slimes) can not be tripped.

[Two-Handed Weapon Style]
1 Slot: +1/2 attack per round.
2 Slots: +1 attack per round.
Strength modifier to your melee damage is increased by 50%.

[Two-Weapon Style]
-1/2 attack per round, unless 5 proficiency points are put into Two-Weapon Style (See the component 'More proficiency points can be spent to all Weapon Styles').
0 Slot: -2 to melee damage.
1 Slot: -2 to melee damage while +1 bonus to melee AC.
2 Slots: -1 to melee damage while +2 bonus to melee AC.
3 Slots: +2 bonus to melee AC.

[Sword and Shield Style]
With a shield that blocks the enemy's view, you can make a sudden strike with +2 bonus to attack rolls per round.
1 Slot: +1 bonus to melee AC, one additional Shield Bash on nearest enemy per round besides normal attacks, which can break down your enemy's defense (-2 penalty to AC) for a while and knock him back. The enemy can make a save vs. breath with a +6 bonus to avoid the shield bash (-1 save penalty for every 4 levels of the attacker).
2 Slots: +2 bonus to melee AC, one additional Shield Bash on nearest enemy per round besides normal attacks, which casues stunning damage of 1D4 + strength modifier and an extra stunning check.  The enemy can make a save vs. breath with a +6 bonus to avoid being stunned (-1 save penalty for every 4 levels of the attacker), but he'll still suffer a defense break and being knocked back.
A hasted character can cast sudden strike and shield bash twice in one round.
Effects of this style are allowed when using ranged weapons, except a bow or a crossbow.

[Unarmed (Monks only)]
Twice special attacks in each round for tripping your enemy. When the monk has one weaopn (no matter one or two handed) in his hand, his special attack works as a tripping of rank 1 Single-Weapon Style. While nothing in hand, it works as a tripping of rank 2 Single-Weapon Style.
For a monk armed with 2 weaopns, he losses his tripping attack ability.


Detailed ajustments for weapon types:

If you have an one-handed light weapon (dagger, short sword, wakizashi, etc., or with bare hands) in one hand with another hand unarmed, your dexterity modifier bonus is added to THAC0 (the bonus is 1, 2, 3, 4, 5 when dexterity reaches 16, 17, 19, 21, 24); if the other hand is armed, there is no dexterity modifier, but +1 bonus to melee AC and off-hand THAC0. 
If you're using a two-handed light weapon (spear, staff), you gets +1 bonus to melee AC and THAC0.

If you have an long-edged weapon (scimitar, long sword, bastar sword, katana, etc.) in one hand with another hand unarmed, you have 33% chance to exert a small AOE with slashing damage of 1D6 plus 50% of strength modifier. However, the direct damage of this attack is reduced by 3 points and minus 50% of strength modifier. If the other hand is also armed, the probability of exerting AOE is halved. 
If you're using a two-handed long-edged weapon (two-handed sword in original game, two-handed katana and bastar sword provided by other MODs),  you have 66% chance to exert a larger AOE with slashing damage of 1D10 plus 50% of strength modifier (as the Component of 'Rebalance for Weapon Styles' raises the two-handed strength modifier to 150%, the modifier here is actually 75% of the original strength modifier). However, the direct damage of this attack is reduced by 5 points and minus 50% of strength modifier. There is also an AOE with a two-handed halberds, but the probability is 33%.
For convenience, such AOEs won't hurt teammates.
If an AOE is triggered on a critical strike, it will be cast once more.

If you have an one-handed bludgeon weapon (war hammer, mace, flail, morning star, etc.) in one hand with another hand unarmed, you have chance (grows with your strength, 0% at 10 str, 30% at 25 str, half for axes) to exert a mighty blow, which can break down your enemy's defense (-2 penalty to AC) for a while and knock him back (save vs. breath). If the other hand is also armed, the probability of mighty blow is halved. 
If you're using a two-handed hammer (provided by other MODs), you have chance (grows with your strength, 0% at 10 str, 45% at 25 str, half for two-handed axes from Icewind Dale or other MODs) to exert a mighty blow, which can stun your enemy or even knock them down. The enemy who makes a save vs. breath only suffers a short penalty of -2 to AC and knocking back.

If you're using an one-handed weapon with hooking property (axe, war hammer, or one-handed halberd provided by other MODs), you obtain one special attack in each round that can hook your foe's weapon, aromr or limbs to drag him. The enemy loses his balance (-4 penalty to AC and THAC0) for a short while unless saves vs. breath.
If you're using an two-handed weapon with hooking property (halberd, or two-handed axe and war hammer provided by other MODs), you obtain one special attack in each round that can hook your foe's weapon, aromr or limbs to drag him down to the floor unless saves vs. breath, with 10% chance to disarm his weapons (only affects humanoids). 
The dragging takes effect when the enemy's strength does not exceed the character's strength by more than 2 points.
Tripping (Single-Weapon Style) has priority over dragging when they're both available. If the tripping fails, then dragging becomes effective on the next attack.
A hasted character can make two dragging attacks in one round.

If you're using an two-handed spear, you get +2 to damage.

For the special attacks above that require save vs. breath, the enemy can make save with a +6 bonus initially, and with -1 save penalty for every 4 levels of the attacker.


Allies and foes also obtain similar Modification of Weapon Styles:

Creatures of warrior classes that hold spears, staves or halberds are treated to be rank 2 in Two-Handed Weapon Style, for non-warrior classes they're treated to be rank 1.
Creatures of warrior classes that hold shields are treated to be rank 2 in Sword and Shield Style, for non-warrior classes they're treated to be rank 1.
Creatures of warrior classes without shields in hands obtain +1/2 attack per round.
Monks obtain a trip attack per round, which acts the same as trip attack of rank 2 Single-Weapon Style.

Allies and foes also obtain similar Detailed ajustments for weapons:

Creatures with one-handed light weapons gain dexterity modifier on THAC0; Creatures with two-handed light weapons gain +1 bonus to melee AC and THAC0.
Creatures without shields in hands who equip long-edged weapons, bludgeon weapons, or weapons with tripping property, can also cast cleave, mighty blow and hook attacks respectively. Such special attacks are switched to two-handed version when their strengths are over 18.



②More proficiency points can be spent to all Weapon Styles

Option 1 (Recommended): Not actually increase the rank limit of Weapon Styles, it automatically deducts one rank when reaches rank 2 or 3 in exchange for additional rewards. Compatible with everything.
When each Weapon Style reaches rank 2, it automaticly decreases to rank 1 ( in battle ) in exchange for +1 bonus to melee damage, melee AC, tohit and attack speed. There's no more decline when it reaches rank 2 again.
When Two-Weapon Style reaches rank 3, it decreases to rank 2 ( in battle ). When it reaches rank 3 again (5 points invested totally), the penalty of -1/2 attack per round no longer exists.
When switched to Mode 0 that turns off all effects of Rebalance for Weapon Styles, deducted weapon proficiency points can be refunded, but only for the case that no more points are invested over deducted Weapon Style slot.

Option 2: More proficiency points can be actually put on the 4 Weapon Styles, but not compatible with other MODs that also modifies Weapon Styles, and requires to be installed after all new Kits.



③Extra modifiers of Intelligence/Wisdom/Charisma

Intelligence, Wisdom and Charisma modifies casting level of Wizards, Priests/Paladins/Rangers/Druids/Shamans and Sorcerers/Bards respectively.
Charisma modifies turn undead level of Priests/Paladins.
Wisdom modifies AC of Monks.
While a bard is singing, friendly creatures in 30' obtain save bonus vs. school of conjurer/enchanter/necromancer same as the bard's Charisma modifier.
While a shaman is dancing, sprits in 30' obtain bonus of AC/THAC0/damage/saves the same rank as the shaman's Wisdom modifier.
Both allies and enemies gain modifiers of 1/2/3/4/5/6/7 with corresponding attribute of 13/15/17/19/21/23/25.
All modifications are active as long as other effects of Rebalance for Weapon Styles exist. It only turns off on Mode 0.

Option 1 (Recommended): Only actives in battle. Compatible with everything.

Option 2: Takes effects anytime (except Bard Song and Shaman Dance) but more burden on game engine.


///////////Version History///////////

V 1.0
Solved the problem that game crashes on death of teammates.
Solved the problem that all effects do not work on some areas.
Add the component "Extra modifications of Intelligence/Wisdom/Charisma", which is effective on both allies and enemies. On Mode 0 it turns off.
Shield Strike is no longer allowed when using a bow or crossbow (other ranged weapons are still allowed).
Effective range of Shield Strike is slightly increased, and the caster no longer moves with Shield Strike.
Since the decrease in direct damage by Cleave reduces the total damage of a critical strike, now if a Cleave is triggered on a critical strike, it will be cast once more.
When an enemy suffers your special attacks such as tripping, mighty blow and dragging, even if he is not stunned or knocked down, a small flame animation prompt appears above his head as long as he receives AC or THAC0 penalties.
The Difficulty Class of saves v.s various special attacks grows with 1 point / 4 levels now (e.g. saves with +6 bonus on level 1, -4 penalty on level 40 and -6 penalty on level 48).
Two Options available for Component 2: Deducts 1 or 2 proficiency points of Weapon Styles in exchange for extra benefits (compatible with everything); More proficiency points can be actually put on Weapon Styles (but with compatibility issues). On Ｍode 0 that turns off all effects of Rebalance for Weapon Styles, deducted weapon proficiency points can be refunded, but only for the case that no more points are invested over deducted Weapon Style slot.

V 0.9
Detailed description of tripping attack ability of armed monks.
The script has been optimized to solve the problem of unstable effects when entering and exiting some small areas during combat.
Fixed the damage bonus of Two-Weapon Style again. They should be correct this time.
Increased duration of some important effects again so that they become more stable.

V 0.8
Increased duration of various effects so that they become more stable.
All skills that require save vs. breath are modified as making save with a +6 bonus initially, and -1 save penalty for every 4 levels of the attacker.
Improved Single-Weapon Style: If you successfully tripped your opponent, or he is is already in a helpless state (stunned / hold / unconsciousness), you can continue to cast tripping without the limitation of once per round.
Adjustment of tripping effect: A tripped foe will be punished on THAC0 and AC. All effects are shortened to 2 seconds, and a rank 1 Single-Weapon Style has 25% chance to only prevent the enemy from moving. 
Tripping has priority over dragging when they're both available. If the tripping fails, then dragging becomes effective on the next attack.
Monks can cast tripping twice per round since they can't be hasted.
Effects of mighty blow and dragging attacks can be immuned by certain spells or items.
Neutral creatures will no longer cast shield bash on players.
Fixed the damage bonus of Two-Weapon Style.

V 0.7
Added a mode switch button to the protagonist's skill bar to chooce modification modes.
Components 'Detailed ajustments for different weapons' and 'Similar benefits for allies and enemies' are merged into 'Rebalance for Weapon Styles'.

V 0.6
Fixed the problem that Cleave hurts allies. 
Adjustment of Cleave's range. 
Tried again to reduce waiting time before saving the game. 
Increase the sprint speed of the character when casting Shield Bash.

V 0.5
Fixed the problem that component 4 did not work. Now component 4 also allows friendly creatures to gain similar abilities. 
Creatures will not cast Shield Bash under special conditions such as invisibility, singing, disability, etc. 
Fixed a problem that damage of Shield Bash failed to increase with strength. 
Shield Bash now shows "A Shield Bash B" instead of "B Bashed by shield" .
Action of the shield strike is more obvious, and now has a sound effect.
Each Weapon Style will give a hint when its rank decreases due to component 2. 
Fix some other details.

V 0.4
Added a little visual effect better than nothing for shield bash.
Fixed the problem that damage with Two-Handed Weapon Style was greater than expected.
Fixed the problem that tohit of sudden strike with Sword and Shield Style may be greater than expected.
The problem that the game could not be saved immediately after a battle was not solved, but the waiting time before saving the game is greatly reduced.

V 0.3
Fixed a serious problem that causes game crashing. 
Fixed some detailed bugs. 
Increased damage of cleave (50% of strength bonus).

V 0.2
Fixed some problems. 
New components: 'Detailed ajustments for different weapons' and 'Similar benefits for enemies'

V 0.1
Components: 'Rebalance for Weapon Styles' and 'More proficiency points can be spent to all Weapon Styles'